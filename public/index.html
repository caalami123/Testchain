<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ethereum Test Wallet</title>
<style>
body{font-family:Arial;margin:20px;} input, button{margin:5px;padding:10px;}
</style>
</head>
<body>
<h2>Ethereum Test Wallet</h2>

<div>
    <button onclick="createWallet()">Create Wallet</button>
    <input id="importKey" placeholder="Private Key">
    <button onclick="importWallet()">Import Wallet</button>
</div>

<div id="walletInfo"></div>

<h3>Send ETH</h3>
<input id="receiver" placeholder="Receiver Address">
<input id="amount" type="number" placeholder="Amount ETH">
<button onclick="sendEth()">Send</button>

<h3>Balance</h3>
<button onclick="checkBalance()">Check Balance</button>
<div id="balance"></div>

<script>
const SERVER_URL = location.origin;
let currentWallet = null;

async function createWallet(){
    const res = await fetch(`${SERVER_URL}/createWallet`, {method:'POST'});
    const data = await res.json();
    currentWallet = data;
    document.getElementById('walletInfo').innerText = `Address: ${data.address}\nPrivate Key: ${data.privateKey}`;
}

async function importWallet(){
    const key = document.getElementById('importKey').value.trim();
    const res = await fetch(`${SERVER_URL}/importWallet`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ privateKey: key })
    });
    const data = await res.json();
    if(data.error){ alert(data.error); return; }
    currentWallet = data;
    document.getElementById('walletInfo').innerText = `Address: ${data.address}\nPrivate Key: ${data.privateKey}`;
}

async function sendEth(){
    if(!currentWallet){ alert('Create or import wallet first'); return; }
    const to = document.getElementById('receiver').value.trim();
    const amount = Number(document.getElementById('amount').value);
    const res = await fetch(`${SERVER_URL}/sendEth`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ fromPrivateKey: currentWallet.privateKey, to, amount })
    });
    const data = await res.json();
    if(data.error) alert(data.error);
    else alert('Transaction Hash: ' + data.txHash);
}

async function checkBalance(){
    if(!currentWallet){ alert('Create or import wallet first'); return; }
    const res = await fetch(`${SERVER_URL}/balance/${currentWallet.address}`);
    const data = await res.json();
    if(data.error) alert(data.error);
    else document.getElementById('balance').innerText = `${data.balance} ETH`;
}
</script>
</body>
</html>
